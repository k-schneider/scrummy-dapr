@inherits FluxorComponent
@inject IDispatcher Dispatcher
@inject IState<GameState> GameState
@inject NavigationManager NavigationManager

<div class="relative">
    <button @onclick="OpenPopover" class="flex justify-center items-center space-x-2 bg-orange-600 text-slate-200 text-xl font-bold py-2 px-6 border-b-4 border-orange-800 hover:bg-orange-500 hover:border-orange-700 active:mt-1 active:border-b-0 rounded-lg shadow-md">
        <span>Invite</span>
        <i class="fa-solid fa-envelope-open-text text-2xl"></i>
    </button>

    @if (GameState.Value.InvitePopoverOpen)
    {
        <div @onclick="ClosePopover" class="fixed inset-0 h-full w-full z-10 bg-black/25 backdrop-blur-sm"></div>

        <div class="absolute left-0 mt-2 py-2 px-4 w-96 bg-white rounded-md shadow-xl z-20 flex flex-col space-y-2">
            <p class="text-center text-indigo-700 font-semibold">Invite players by sending them this link:</p>
            <input type="text" readonly value="@NavigationManager.Uri" class="text-xl bg-gray-50 border border-gray-300 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 block w-full p-2.5" />
            <div>
                <button @onclick="CopyLinkToClipboard" class="w-full flex justify-center items-center space-x-4 bg-orange-600 text-slate-200 text-xl font-bold py-2 px-6 border-b-4 border-orange-800 hover:bg-orange-500 hover:border-orange-700 active:mt-1 active:border-b-0 rounded-lg shadow-md">
                    <span>Copy link to clipboard</span>
                    <i class="fa-solid fa-clipboard-list text-2xl"></i>
                </button>
            </div>
        </div>
    }
</div>

@code {
    private void ClosePopover()
    {
        Dispatcher.Dispatch(new CloseInvitePopoverAction());
    }

    private void CopyLinkToClipboard()
    {
        Dispatcher.Dispatch(new CopyLinkToClipboardAction());
    }

    private void OpenPopover()
    {
        Dispatcher.Dispatch(new OpenInvitePopoverAction());
    }
}
