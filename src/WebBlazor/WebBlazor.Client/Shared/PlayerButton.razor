@inherits FluxorComponent
@inject IDispatcher Dispatcher
@inject IState<GameState> GameState

<div class="relative">
    <button @onclick="OpenPopover" class="flex justify-center items-center space-x-2 bg-orange-400 text-slate-800 text-xl font-bold py-2 px-6 border-b-4 border-orange-500 hover:bg-orange-300 hover:border-orange-400 active:mt-1 active:border-b-0 rounded-lg shadow-md">
        <span>Kevin</span>
        <i class="fa-solid fa-face-smile-beam text-2xl"></i>
    </button>

    @if (GameState.Value.PlayerPopoverOpen)
    {
        <div @onclick="ClosePopover" class="fixed inset-0 h-full w-full z-10 bg-black/25 backdrop-blur-sm"></div>

        <div class="absolute right-0 mt-2 w-96 bg-white rounded-md shadow-xl z-20 flex flex-col">
            <div class="flex flex-col space-y-2 p-4">
                <label class="w-full text-center text-lg font-semibold">Nickname</label>
                <input type="text" class="text-xl bg-gray-50 border border-gray-300 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 block w-full p-2.5" />
                <button class="w-full flex justify-center items-center space-x-4 bg-orange-600 text-slate-200 text-xl font-bold py-2 px-6 border-b-4 border-orange-800 hover:bg-orange-500 hover:border-orange-700 active:mt-1 active:border-b-0 rounded-lg shadow-md">
                    Update Your Nickname
                </button>
            </div>
            <div class="bg-stone-200 p-4">
                <p class="w-full text-center text-lg font-semibold">Player Settings</p>
                <p class="w-full text-center mt-2">todo: Toggle for specator mode</p>
            </div>
            <div class="p-4">
                <button @onclick="LeaveGame" class="w-full flex justify-center items-center space-x-4 bg-orange-600 text-slate-200 text-xl font-bold py-2 px-6 border-b-4 border-orange-800 hover:bg-orange-500 hover:border-orange-700 active:mt-1 active:border-b-0 rounded-lg shadow-md">
                    <span>Leave Game</span>
                    <i class="fa-solid fa-arrow-right-from-bracket text-2xl"></i>
                </button>
            </div>
        </div>
    }
</div>

@code {
    private void ClosePopover()
    {
        Dispatcher.Dispatch(new ClosePlayerPopoverAction());
    }

    private void LeaveGame()
    {
        Dispatcher.Dispatch(new LeaveGameAction());
    }

    private void OpenPopover()
    {
        Dispatcher.Dispatch(new OpenPlayerPopoverAction());
    }
}
